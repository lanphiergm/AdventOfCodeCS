//#define USESAMPLE
using Microsoft.Extensions.Logging;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Text;

namespace AdventOfCode.Problems.Year2020
{
    class Day20JurassicJigsaw : ProblemBase<long>
    {
        private readonly List<Tile> _tiles = new List<Tile>();
        private const int TOP = 0;
        private const int RIGHT = 1;
        private const int BOTTOM = 2;
        private const int LEFT = 3;

        public Day20JurassicJigsaw(ILogger logger) : base(logger, "Jurassic Jigsaw", 2020, 20) { }

        protected override long ExecutePart1()
        {
            Initialize();
            MatchEdges();
            var corners = _tiles.Where(t => t.IsCorner);
            Debug.Assert(corners.Count() == 4);
            long cornerProduct = 1;
            foreach (var tile in corners)
            {
                cornerProduct *= tile.Id;
            }
            return cornerProduct;
        }

        protected override long ExecutePart2()
        {
            Initialize();
            MatchEdges();
            var image = AssembleImage();
            long seaMonsterCount = 0;
            bool[,] waves = null;
            for (int flip = 0; flip < 2; flip++)
            {
                for (int rotate = 0; rotate < 4; rotate++)
                {
                    (seaMonsterCount, waves) = CountSeaMonsters(image);
                    if (seaMonsterCount > 0)
                    {
                        break;
                    }
                    image = Rotate(image);
                }
                if (seaMonsterCount > 0)
                {
                    break;
                }
                image = FlipY(image);
            }

            int waveCount = 0;
            for (int i = 0; i <= waves.GetUpperBound(0); i++)
            {
                for (int j = 0; j <= waves.GetUpperBound(1); j++)
                {
                    if (waves[i, j])
                    {
                        waveCount++;
                    }
                }
            }
            return waveCount;
        }

        private bool[,] AssembleImage()
        {
            int tileGridSize = (int)Math.Sqrt(_tiles.Count);
            var image = new bool[tileGridSize * 8, tileGridSize * 8];
            Tile rowStart = _tiles.First(t => t.IsCorner);
            while (rowStart.Edges[TOP].Neighbor != null || rowStart.Edges[LEFT].Neighbor != null)
            {
                rowStart.Rotate();
            }

            Tile currTile;
            for (int yTile = tileGridSize - 1; yTile >= 0; yTile--)
            {
                currTile = rowStart;
                for (int xTile = 0; xTile < tileGridSize; xTile++)
                {
                    //Copy this tile's data
                    for (int y = 1; y < 9; y++)
                    {
                        for (int x = 1; x < 9; x++)
                        {
                            image[xTile * 8 + x - 1, yTile * 8 + y - 1] = currTile.Pixels[x, y];
                        }
                    }

                    //Prepare the next tile to the right
                    var nextTile = currTile.Edges[RIGHT].Neighbor?.Tile;
                    if (nextTile != null)
                    {
                        while (!ReferenceEquals(currTile.Edges[RIGHT], nextTile.Edges[LEFT].Neighbor))
                        {
                            nextTile.Rotate();
                        }
                        if (nextTile.Edges[LEFT].IsInverted)
                        {
                            nextTile.FlipY();
                        }
                    }
                    currTile = nextTile;
                }

                //Prepare the next tile down
                var nextRow = rowStart.Edges[BOTTOM].Neighbor?.Tile;
                if (nextRow != null)
                {
                    while (!ReferenceEquals(rowStart.Edges[BOTTOM], nextRow.Edges[TOP].Neighbor))
                    {
                        nextRow.Rotate();
                    }
                    if (rowStart.Edges[BOTTOM].IsInverted)
                    {
                        nextRow.FlipX();
                    }
                    Debug.Assert(nextRow.Edges[LEFT].Neighbor == null);
                }
                rowStart = nextRow;
            }

            return image;
        }

        private static bool[,] Rotate(bool[,] image)
        {
            int n = image.GetUpperBound(0) + 1;
            var rotated = new bool[n, n];
            for (int i = 0; i < n; i++)
            {
                for (int j = 0; j < n; j++)
                {
                    rotated[i, j] = image[n - j - 1, i];
                }
            }
            return rotated;
        }

        private static bool[,] FlipY(bool[,] image)
        {
            int n = image.GetUpperBound(0) + 1;
            var flipped = new bool[n, n];
            for (int i = 0; i < n; i++)
            {
                for (int j = 0; j < n; j++)
                {
                    flipped[i, j] = image[i, n - j - 1];
                }
            }
            return flipped;
        }

        private static bool[,] FlipX(bool[,] image)
        {
            int n = image.GetUpperBound(0) + 1;
            var flipped = new bool[n, n];
            for (int i = 0; i < n; i++)
            {
                for (int j = 0; j < n; j++)
                {
                    flipped[i, j] = image[n - i - 1, j];
                }
            }
            return flipped;
        }

        private static (int count, bool[,] waves)  CountSeaMonsters(bool[,] image)
        {
            int count = 0;
            for (int y = 0; y < image.GetUpperBound(1) - 2; y++)
            {
                for (int x = 0; x < image.GetUpperBound(0) - 18; x++)
                {
                    bool found = true;
                    foreach (var (xOffset, yOffset) in seaMonsterOffsets)
                    {
                        if (!image[x + xOffset, y + yOffset])
                        {
                            found = false;
                            break;
                        }
                    }
                    if (found)
                    {
                        count++;
                        foreach (var (xOffset, yOffset) in seaMonsterOffsets)
                        {
                            image[x + xOffset, y + yOffset] = false;
                        }
                    }
                }
            }
            return (count, image);
        }

        private void MatchEdges()
        {
            for (int i = 0; i < _tiles.Count - 1; i++)
            {
                foreach (Edge edge in _tiles[i].Edges.Where(e => e.Neighbor == null))
                {
                    for (int j = i + 1; j < _tiles.Count; j++)
                    {
                        foreach (Edge otherEdge in _tiles[j].Edges.Where(e => e.Neighbor == null))
                        {
                            if (DoEdgesMatch(edge, otherEdge))
                            {
                                edge.Neighbor = otherEdge;
                                otherEdge.Neighbor = edge;
                            }
                        }
                        if (edge.Neighbor != null)
                        {
                            break;
                        }
                    }
                }
            }
        }

        private static bool DoEdgesMatch(Edge a, Edge b)
        {
            return Enumerable.SequenceEqual(a.Pixels, b.Pixels) ||
                   Enumerable.SequenceEqual(a.Pixels, b.Pixels.Reverse());
        }

        private class Tile
        {
            public bool[,] Pixels { get; private set; } = new bool[10, 10];

            public Tile(int id)
            {
                Id = id;
            }

            public int Id { get; }

            public Edge[] Edges { get; } = new Edge[4];

            public bool IsCorner => Edges.Where(e => e.Neighbor == null).Count() == 2;

            public void FlipX()
            {
                Pixels = Day20JurassicJigsaw.FlipX(Pixels);
                Edge temp = Edges[LEFT];
                Edges[LEFT] = Edges[RIGHT];
                Edges[RIGHT] = temp;

                foreach (var edge in Edges)
                {
                    edge.Reverse();
                }
            }

            public void FlipY()
            {
                Pixels = Day20JurassicJigsaw.FlipY(Pixels);
                Edge temp = Edges[TOP];
                Edges[TOP] = Edges[BOTTOM];
                Edges[BOTTOM] = temp;

                foreach (var edge in Edges)
                {
                    edge.Reverse();
                }
            }

            public void Rotate()
            {
                Pixels = Day20JurassicJigsaw.Rotate(Pixels);
                Edge temp = Edges[TOP];
                Edges[TOP] = Edges[LEFT];
                Edges[LEFT] = Edges[BOTTOM];
                Edges[BOTTOM] = Edges[RIGHT];
                Edges[RIGHT] = temp;
            }

        }

        private class Edge
        {
            public Edge(Tile tile)
            {
                Tile = tile;
            }

            public bool[] Pixels { get; private set; } = new bool[10];
            public Edge Neighbor { get; set; }
            public Tile Tile { get; }

            public bool IsInverted => Neighbor != null && Enumerable.SequenceEqual(Pixels, Neighbor.Pixels);

            public void Reverse()
            {
                Pixels = Pixels.Reverse().ToArray();
            }
        }

        private void Initialize()
        {
            if (_tiles.Any())
            {
                return;
            }

            for (int row = 0; row < tileData.Length; row += 12)
            {
                var tile = new Tile(int.Parse(tileData[row][5..^1]));
                for (int i = 0; i < 10; i++)
                {
                    for (int j = 0; j < 10; j++)
                    {
                        if (tileData[row + i + 1][j] == '#')
                        {
                            tile.Pixels[j, 9 - i] = true;
                        }
                    }
                }

                var top = new Edge(tile);
                var right = new Edge(tile);
                var bottom = new Edge(tile);
                var left = new Edge(tile);
                for (int i = 0; i < 10; i++)
                {
                    top.Pixels[i] = tile.Pixels[i, 9];
                    right.Pixels[i] = tile.Pixels[9, 9 - i];
                    bottom.Pixels[i] = tile.Pixels[9 - i, 0];
                    left.Pixels[i] = tile.Pixels[0, i];
                }
                tile.Edges[TOP] = top;
                tile.Edges[RIGHT] = right;
                tile.Edges[BOTTOM] = bottom;
                tile.Edges[LEFT] = left;
                _tiles.Add(tile);
            }
        }

        private void PrintImage(bool[,] image)
        {
            for (int i = image.GetUpperBound(1); i >= 0; i--)
            {
                var row = new StringBuilder();
                for (int j = 0; j <= image.GetUpperBound(0); j++)
                {
                    row.Append(image[j, i] ? '#' : '.');
                }
                Logger.LogInformation(row.ToString());
            }
            Logger.LogInformation(string.Empty);
        }

        #region Data

        private static readonly (int xOffset, int yOffset)[] seaMonsterOffsets =
        {
            (18, 2),
            (0, 1), (5, 1), (6, 1), (11, 1), (12, 1), (17, 1), (18, 1), (19, 1),
            (1, 0), (4, 0), (7, 0), (10, 0), (13, 0), (16, 0)
        };

#if USESAMPLE
        private static readonly string[] tileData =
        {
            "Tile 2311:",
            "..##.#..#.",
            "##..#.....",
            "#...##..#.",
            "####.#...#",
            "##.##.###.",
            "##...#.###",
            ".#.#.#..##",
            "..#....#..",
            "###...#.#.",
            "..###..###",
            "",
            "Tile 1951:",
            "#.##...##.",
            "#.####...#",
            ".....#..##",
            "#...######",
            ".##.#....#",
            ".###.#####",
            "###.##.##.",
            ".###....#.",
            "..#.#..#.#",
            "#...##.#..",
            "",
            "Tile 1171:",
            "####...##.",
            "#..##.#..#",
            "##.#..#.#.",
            ".###.####.",
            "..###.####",
            ".##....##.",
            ".#...####.",
            "#.##.####.",
            "####..#...",
            ".....##...",
            "",
            "Tile 1427:",
            "###.##.#..",
            ".#..#.##..",
            ".#.##.#..#",
            "#.#.#.##.#",
            "....#...##",
            "...##..##.",
            "...#.#####",
            ".#.####.#.",
            "..#..###.#",
            "..##.#..#.",
            "",
            "Tile 1489:",
            "##.#.#....",
            "..##...#..",
            ".##..##...",
            "..#...#...",
            "#####...#.",
            "#..#.#.#.#",
            "...#.#.#..",
            "##.#...##.",
            "..##.##.##",
            "###.##.#..",
            "",
            "Tile 2473:",
            "#....####.",
            "#..#.##...",
            "#.##..#...",
            "######.#.#",
            ".#...#.#.#",
            ".#########",
            ".###.#..#.",
            "########.#",
            "##...##.#.",
            "..###.#.#.",
            "",
            "Tile 2971:",
            "..#.#....#",
            "#...###...",
            "#.#.###...",
            "##.##..#..",
            ".#####..##",
            ".#..####.#",
            "#..#.#..#.",
            "..####.###",
            "..#.#.###.",
            "...#.#.#.#",
            "",
            "Tile 2729:",
            "...#.#.#.#",
            "####.#....",
            "..#.#.....",
            "....#..#.#",
            ".##..##.#.",
            ".#.####...",
            "####.#.#..",
            "##.####...",
            "##..#.##..",
            "#.##...##.",
            "",
            "Tile 3079:",
            "#.#.#####.",
            ".#..######",
            "..#.......",
            "######....",
            "####.#..#.",
            ".#...#.##.",
            "#.#####.##",
            "..#.###...",
            "..#.......",
            "..#.###..."
        };
#else
        private static readonly string[] tileData =
        {
            "Tile 3209:",
            ".##.####..",
            "....#....#",
            "#.##.#....",
            "#.....#...",
            "#..#......",
            ".##.##..##",
            "##.#......",
            "#.######..",
            "....##..#.",
            "....######",
            "",
            "Tile 1409:",
            ".##.####..",
            "...#...#.#",
            "#....#.#..",
            "#...##.##.",
            ".###....#.",
            "..#....#..",
            "##...#....",
            ".....#....",
            "......#..#",
            ".#.#.#####",
            "",
            "Tile 1039:",
            "##...#.##.",
            "..#.##..##",
            "#......#.#",
            "#.#.#....#",
            "####...#.#",
            "#..#.....#",
            "#.....#...",
            ".#..#...##",
            "..#....##.",
            "#.#.#.####",
            "",
            "Tile 3037:",
            "#..##.#.##",
            "##.......#",
            ".#......##",
            ".........#",
            "..........",
            "...#.#....",
            "#...####.#",
            "...#..#.##",
            ".........#",
            "#..###.#..",
            "",
            "Tile 1427:",
            "#..#.#..#.",
            "......##..",
            "#.......##",
            "..#..#....",
            "#...###.#.",
            ".......#.#",
            ".#.......#",
            ".#...##...",
            "......#...",
            ".#.#.#....",
            "",
            "Tile 2879:",
            "###..#.#..",
            "#....##...",
            "..#..#....",
            "#.....#...",
            ".#.......#",
            "#......#.#",
            ".#.#.....#",
            "#.....#..#",
            "..........",
            "####.##...",
            "",
            "Tile 3617:",
            "...#.#..#.",
            "#...#....#",
            "...#.#...#",
            "#.....#..#",
            "#........#",
            "......#..#",
            "#.......##",
            "....#....#",
            ".##......#",
            "##.####..#",
            "",
            "Tile 1801:",
            "..###...##",
            "#.###.....",
            ".###....##",
            "#...#.....",
            "#........#",
            ".#.##...##",
            "#.#..#...#",
            "###.#....#",
            "#.#......#",
            "##.##.##.#",
            "",
            "Tile 3221:",
            ".##.###.##",
            "#..##....#",
            "#.#.#.#.#.",
            "#...#.#...",
            "#.....##..",
            "......#..#",
            "..........",
            "#...#.##..",
            "...#...#..",
            ".###...##.",
            "",
            "Tile 1987:",
            ".##.###.##",
            ".##....###",
            "#..#.#.##.",
            ".#..##...#",
            ".....##..#",
            ".......#..",
            "#......##.",
            "#.#.....##",
            "......##.#",
            "###...#...",
            "",
            "Tile 2917:",
            "#.#..#..##",
            "......##..",
            ".#........",
            "##.......#",
            ".#.......#",
            "..#.#.#...",
            "...#.#...#",
            "...##..##.",
            "........##",
            ".#.#.#.#.#",
            "",
            "Tile 1297:",
            "#..#.##...",
            "...##..#.#",
            "....#...##",
            "##.#.#.##.",
            "#.......##",
            "#.........",
            "####......",
            "#.........",
            "#.........",
            ".#....###.",
            "",
            "Tile 1613:",
            "#...####..",
            ".....#.###",
            ".....#.##.",
            "#.#......#",
            "...##...##",
            "#.........",
            ".##..#....",
            "....#.....",
            "..........",
            "..##.##.##",
            "",
            "Tile 1481:",
            "#.##..##..",
            "#.#..#.#.#",
            "..........",
            "##..#..#..",
            "..##....#.",
            "..#...#.#.",
            "#..#......",
            "##.....#..",
            "...#.....#",
            ".#.####..#",
            "",
            "Tile 3779:",
            "##.#......",
            "...#.....#",
            "...#......",
            "##.##.#..#",
            "##......##",
            "#..#...#..",
            "....#.#.##",
            "#......#.#",
            ".......#.#",
            "#...###..#",
            "",
            "Tile 3121:",
            ".#.#..#.##",
            "#..#.#.#..",
            "....#.....",
            "#..#.#.#..",
            ".......###",
            "#.#......#",
            "#.....#..#",
            "#.#.#....#",
            "...#.#....",
            ".##..#.##.",
            "",
            "Tile 1913:",
            "##..##...#",
            ".......##.",
            "##..#..#..",
            "##..#....#",
            "..........",
            "#.#...#..#",
            ".........#",
            ".......###",
            "......#.##",
            ".#...##.#.",
            "",
            "Tile 3929:",
            ".#...#####",
            ".#.......#",
            "#...#.....",
            "..#.##....",
            "###..##...",
            "..#.....#.",
            "......#...",
            "#........#",
            ".........#",
            "##..##....",
            "",
            "Tile 3947:",
            "#...#.#..#",
            "......#...",
            "#.#...#...",
            "........#.",
            "..#.#.....",
            "#....#.##.",
            "..........",
            "##..#.....",
            "##....#.##",
            "##.###.###",
            "",
            "Tile 2663:",
            ".#.#.#.##.",
            "....###...",
            "#..#......",
            "#...#.####",
            "##......#.",
            "#.###.#..#",
            "#..#...#.#",
            "..#......#",
            "##......#.",
            "....##..##",
            "",
            "Tile 3499:",
            "########.#",
            "....#..#.#",
            ".#.##....#",
            "......#...",
            ".#..#..#..",
            "#..#.....#",
            "###...##..",
            "#..##.....",
            "#.#...#..#",
            "#..###.##.",
            "",
            "Tile 3877:",
            "..######.#",
            "..#.#....#",
            ".#........",
            "##..##..##",
            ".#.#...#.#",
            ".....#.###",
            ".........#",
            "#........#",
            ".....#....",
            "#..#.###.#",
            "",
            "Tile 2251:",
            "#.#.......",
            "..##...#.#",
            "#..#..##.#",
            ".#...#..#.",
            "##........",
            "##.##.###.",
            "..#...#...",
            "..#......#",
            "#..#..#...",
            "##..#.#...",
            "",
            "Tile 2357:",
            ".....#.#..",
            ".#.#......",
            "#...###...",
            ".#..##.#.#",
            "#........#",
            "...#....#.",
            "#.........",
            ".##.##.#.#",
            "###...####",
            "...##....#",
            "",
            "Tile 2381:",
            "...####.##",
            "#.......#.",
            "......##..",
            "..#.##.#..",
            "#..###....",
            "##.#..#...",
            ".##..#....",
            "##..#..#..",
            "#....#..#.",
            "#.#...#.#.",
            "",
            "Tile 1693:",
            "###.......",
            "#...####.#",
            "##.##.....",
            "#..#.....#",
            "#.#......#",
            "...#.#....",
            "....#.##.#",
            "..#.#.....",
            "..#.#...#.",
            ".##..###..",
            "",
            "Tile 3697:",
            "....#.#..#",
            "#.........",
            "#.#...#...",
            "..#....##.",
            "#....##.#.",
            "#........#",
            ".#...#....",
            "#...#..#..",
            "#.........",
            "###....#..",
            "",
            "Tile 3307:",
            "####..##.#",
            "........#.",
            "#........#",
            "#..##.##..",
            "#...##..#.",
            "...##.##..",
            "#.....#..#",
            "##.......#",
            "......#.##",
            "##.#..#...",
            "",
            "Tile 1823:",
            "#.##...##.",
            "......#...",
            "#.........",
            "#.........",
            "#.##....##",
            "##..##.#.#",
            ".#........",
            ".#....####",
            "#......#..",
            "#..#..##..",
            "",
            "Tile 2837:",
            ".#...#.#.#",
            "..##.....#",
            "##....##.#",
            "#.#..##.##",
            "###.#....#",
            ".#....#...",
            "..#...#...",
            ".#.#......",
            "#...#.....",
            "#....###..",
            "",
            "Tile 1483:",
            "##.##...#.",
            ".##..##...",
            ".##...#.#.",
            "#...#....#",
            "#..##..#..",
            "#.......##",
            ".....#...#",
            "..###.#..#",
            "#...##.#.#",
            "#...#.####",
            "",
            "Tile 3889:",
            ".#.#.##.#.",
            "...###.#.#",
            "#.....##.#",
            "......#...",
            ".#..#.##.#",
            "##....#...",
            ".###.....#",
            "#..#...#.#",
            "##....#...",
            "#.#..##..#",
            "",
            "Tile 2677:",
            ".......###",
            "#.#..#..#.",
            ".#...##..#",
            ".........#",
            "........##",
            ".......#.#",
            "...#...#.#",
            ".......#..",
            "..#...####",
            "..#..####.",
            "",
            "Tile 1021:",
            "#...######",
            "..#.#.....",
            "........##",
            "#....#..##",
            "#....##.#.",
            "..#......#",
            "#..#.#.#.#",
            "#.....#...",
            ".#.#......",
            ".####.###.",
            "",
            "Tile 3067:",
            "#####..#.#",
            "##..#.##..",
            "#.###...#.",
            "###...#..#",
            "#......#..",
            "###......#",
            "#.....#...",
            ".....#..##",
            "#...#..###",
            "..#.#..#..",
            "",
            "Tile 1559:",
            "..#...#.##",
            "#.......##",
            "....#....#",
            "..##.#..##",
            "##..#..#.#",
            "##.....##.",
            "....#..##.",
            "#.#...##..",
            "....#..#..",
            "#..#.....#",
            "",
            "Tile 3917:",
            "#.######..",
            ".#......#.",
            "#...#...##",
            ".......#..",
            "##......#.",
            "#.......#.",
            "#..##..###",
            "....##...#",
            ".....#....",
            "###...#...",
            "",
            "Tile 3823:",
            "...####.##",
            "....#..#..",
            "......#.#.",
            "......#...",
            "...#..#...",
            "#..##.#...",
            "..#......#",
            "#...#..###",
            ".#.......#",
            ".###..#.#.",
            "",
            "Tile 1307:",
            "...#.....#",
            "##.#.....#",
            "###......#",
            ".....###.#",
            "#..##.##..",
            "#.........",
            "..##.....#",
            "#....#..#.",
            "#.#.#....#",
            "#.##...#.#",
            "",
            "Tile 1949:",
            "....##.#.#",
            "#...#.....",
            "....#.#.#.",
            "#...#.....",
            "#..#......",
            "........##",
            ".#..#.#.##",
            ".....#...#",
            "..........",
            "..##....##",
            "",
            "Tile 1571:",
            "#..#####.#",
            ".....##.##",
            "..#.#..#..",
            "#..#.#....",
            ".....#...#",
            "...#.....#",
            ".#.....##.",
            "##...#...#",
            ".....#...#",
            ".#.#...###",
            "",
            "Tile 2777:",
            "#.###.#..#",
            "#....#..##",
            "#........#",
            "#....#..#.",
            "#.#.......",
            ".#.#...#.#",
            "..#.##....",
            "##........",
            ".....##...",
            "..#.###.##",
            "",
            "Tile 3019:",
            ".##.#####.",
            "...#..##..",
            "...#....##",
            ".........#",
            "#.........",
            "#....#...#",
            "#.........",
            ".......#.#",
            "..##.....#",
            ".##...#...",
            "",
            "Tile 2579:",
            "###.######",
            "##.....#.#",
            ".#....##.#",
            "#.#...#..#",
            "#...##....",
            "....#....#",
            "#.#...#..#",
            "##.......#",
            "###......#",
            "#..##.####",
            "",
            "Tile 2887:",
            "..##..###.",
            "####.##.##",
            ".##..#...#",
            ".#....#...",
            "..#.....##",
            "#..#......",
            "....##...#",
            "..........",
            "..##...#..",
            ".#..##....",
            "",
            "Tile 2287:",
            "..#.####..",
            "##..#.....",
            "....##..#.",
            ".....##...",
            "##..###.##",
            "#....##.#.",
            "##....#...",
            "..........",
            "...#......",
            ".#.#..#.##",
            "",
            "Tile 1637:",
            "###.#...#.",
            "#......###",
            "....###..#",
            "..#..#...#",
            "....#..#.#",
            "....#.....",
            ".........#",
            "#....#.#.#",
            "...###...#",
            ".##..#.#.#",
            "",
            "Tile 1901:",
            ".##.......",
            ".#........",
            "##..##....",
            "......#.#.",
            "....#..#..",
            "#.#...##.#",
            ".#.....#.#",
            "..........",
            "#..#..#..#",
            ".#.##....#",
            "",
            "Tile 2957:",
            "##.###..#.",
            "..###..#.#",
            "#...#.#...",
            ".....#.###",
            "#........#",
            "......#...",
            ".#......##",
            "##...#..##",
            ".#.#.#...#",
            "..###.##..",
            "",
            "Tile 2699:",
            "..#.#.###.",
            ".#...#.#.#",
            "#.....##..",
            "#...#.#..#",
            ".....#..##",
            ".....###..",
            "#..#......",
            "##.#.....#",
            "##.#..#..#",
            "#..#...#..",
            "",
            "Tile 2081:",
            "..#...#...",
            "....#.....",
            "#.#.#.....",
            "..##.##..#",
            "...#...#.#",
            ".####.....",
            ".##..#..#.",
            "#.....##..",
            ".........#",
            "#..##.###.",
            "",
            "Tile 2383:",
            ".####.###.",
            "...##....#",
            "...#....#.",
            "...#.....#",
            "##......#.",
            "...#......",
            "##.#.#...#",
            "##.#...#.#",
            "........##",
            ".##.##.#.#",
            "",
            "Tile 3407:",
            "##..#.###.",
            "#..#..#...",
            "#.......#.",
            ".#.......#",
            "###...#..#",
            "........##",
            "#..###...#",
            "#.....##.#",
            "..##......",
            ".####.....",
            "",
            "Tile 2503:",
            ".###..#...",
            ".......###",
            "##....#.#.",
            ".##.....#.",
            ".#.......#",
            "##.#..#...",
            ".#.......#",
            "....######",
            "...#..#...",
            "...######.",
            "",
            "Tile 1249:",
            "##.#.#####",
            "..#.......",
            ".#.......#",
            "..#.......",
            ".......#..",
            "###....#..",
            "...#.....#",
            ".......###",
            "#.....#..#",
            "..##...##.",
            "",
            "Tile 3541:",
            "..##.#####",
            ".....#....",
            "..##...#.#",
            "..........",
            ".#....##..",
            "..........",
            "..#...##.#",
            "##.#..#.#.",
            "......#..#",
            "..#..#...#",
            "",
            "Tile 1447:",
            ".#...####.",
            "#.#..#...#",
            ".....#.#.#",
            ".....#....",
            ".....#..#.",
            "#.....#..#",
            "..##...#.#",
            "#.##......",
            "..#...#.#.",
            ".#.##.#..#",
            "",
            "Tile 2969:",
            "#..###.#..",
            "#.#..#....",
            "#........#",
            "#..#.#.#..",
            ".#.......#",
            "..#..#.#.#",
            "#........#",
            ".........#",
            "#...#.#...",
            ".###......",
            "",
            "Tile 1621:",
            ".#.#.#....",
            ".#..#....#",
            "....##...#",
            "#.#....#..",
            "..........",
            "##.#..##.#",
            "#.#...#..#",
            "#...#.....",
            ".##....#..",
            "#..#.##.##",
            "",
            "Tile 2129:",
            "######..#.",
            "....#....#",
            "#........#",
            "#.....##..",
            "##.#...#.#",
            "##.##....#",
            "#.........",
            "##..##....",
            "#.#...#..#",
            ".#.....##.",
            "",
            "Tile 1741:",
            ".....#....",
            "#......#..",
            "........#.",
            "#....#..#.",
            ".......#.#",
            "#......#.#",
            "#...##..##",
            "##.....#..",
            "..##.#..#.",
            "....#...#.",
            "",
            "Tile 1549:",
            "#.##.#...#",
            "#.........",
            ".#.....#.#",
            ".#.#.#....",
            ".....#....",
            "......#.##",
            "......####",
            "#.#.#..#..",
            "#...#.....",
            "..#..##..#",
            "",
            "Tile 1063:",
            "####.#####",
            "#........#",
            "##........",
            "##........",
            "........#.",
            "#.#....#..",
            "....#.....",
            ".##.###...",
            "#.........",
            "##.##.#.##",
            "",
            "Tile 3931:",
            ".##......#",
            ".#.......#",
            "...#....#.",
            "#...#.....",
            "....#...#.",
            "..#...##.#",
            "#.#.#..#.#",
            "..........",
            "#..#....#.",
            ".#..#.#...",
            "",
            "Tile 1367:",
            ".##.#.....",
            "##.#......",
            "###....#..",
            ".....#...#",
            "##...###..",
            "#.#....#..",
            "...##....#",
            "#..#...#..",
            "..#...#...",
            "#..#....##",
            "",
            "Tile 1783:",
            "#.#####...",
            "......##.#",
            "#....#.###",
            "..#......#",
            "#.........",
            "###......#",
            "##........",
            "##....#...",
            "#.#.#..#.#",
            "#####.#...",
            "",
            "Tile 1777:",
            "#.....####",
            "#.##..#...",
            ".##.#..##.",
            "..#.#.#...",
            "#....#...#",
            "#......#..",
            "..#.#.#...",
            "#.#.......",
            "#.......##",
            "#.##..##..",
            "",
            "Tile 1487:",
            "...###.###",
            "..........",
            "##.......#",
            "#.#.......",
            "#....#..#.",
            "..#..#....",
            "#.#..#..##",
            ".#.##.#...",
            "........#.",
            "#.####.#..",
            "",
            "Tile 2039:",
            ".#.#######",
            "..#...##..",
            "..#..#...#",
            "##......##",
            "#......#.#",
            "#...##...#",
            "...#...#..",
            "#.##.#....",
            "....####.#",
            ".#..#..##.",
            "",
            "Tile 2833:",
            ".##.#.#..#",
            ".....#.#.#",
            "#.....####",
            "#...#....#",
            "#.......##",
            "#......###",
            "......##..",
            "##.#..##..",
            "##.##..#.#",
            "#.#...#.##",
            "",
            "Tile 3301:",
            "..#.####.#",
            ".#.#...##.",
            "#.#.##.#..",
            ".##.#.....",
            "..#......#",
            "..........",
            "#..##.#.#.",
            "#.......#.",
            "..........",
            ".###...###",
            "",
            "Tile 2963:",
            "..##.##.#.",
            "##....#.##",
            "#.#.#.....",
            "##.......#",
            "....#.....",
            ".....#....",
            "#.#...#...",
            ".#.......#",
            "....#....#",
            "..##..#.##",
            "",
            "Tile 2477:",
            "###.#..###",
            "......#...",
            "#.##.#..##",
            "###...#..#",
            "##....#...",
            "...##...#.",
            "..#....#..",
            "#.#....###",
            "#.#.#.#...",
            "..##.....#",
            "",
            "Tile 2659:",
            "####..##..",
            "..#.##....",
            "#......#..",
            "...#...###",
            "#....###.#",
            ".........#",
            "#.#.......",
            "#.#.#..#.#",
            "##.....#.#",
            "#...#..###",
            "",
            "Tile 1051:",
            "###.#.#..#",
            "#.#..#....",
            "#.......#.",
            "#...##...#",
            "#....#...#",
            ".....#....",
            "##..##..#.",
            "..#......#",
            "#.........",
            "..#####.#.",
            "",
            "Tile 3637:",
            ".#...###.#",
            "#.#.#.....",
            "..#..#.###",
            "...##.....",
            "#..#....##",
            ".........#",
            "#.......#.",
            "..##.#..#.",
            "##......##",
            "#######.##",
            "",
            "Tile 1697:",
            "##.###.#..",
            "....#...##",
            "#.......##",
            "....#....#",
            "#.....#...",
            "#.##......",
            "##.......#",
            "#....#..##",
            "#.........",
            "...#...##.",
            "",
            "Tile 1499:",
            "#...####.#",
            "..#.##.#.#",
            ".##.....##",
            ".##....#..",
            ".##......#",
            ".#......##",
            "#..##.###.",
            "#.#....#..",
            ".##.#.#.##",
            ".#.#.#.#..",
            "",
            "Tile 2543:",
            "#.##.#.##.",
            ".....#....",
            "...#.#...#",
            "#...#..#.#",
            "..##....#.",
            "##..#..#.#",
            "...#......",
            "#.##......",
            "###...####",
            "#..####.#.",
            "",
            "Tile 2269:",
            "###.#..###",
            "..#..#...#",
            "#..#.##..#",
            "#......##.",
            ".#..#.....",
            "#.....#...",
            "#..#.#....",
            ".#......##",
            ".###..#...",
            ".###......",
            "",
            "Tile 2029:",
            "##.###....",
            ".#.....##.",
            ".........#",
            "#.#......#",
            "##.#....#.",
            ".##.#.....",
            "#.........",
            "#...#....#",
            ".........#",
            "...###.##.",
            "",
            "Tile 2141:",
            "#.#.#..#.#",
            "..##.....#",
            "#.........",
            ".##......#",
            "#.#..#.#..",
            "#........#",
            "##..##.#..",
            ".#........",
            "#.#.....##",
            ".....##...",
            "",
            "Tile 1601:",
            ".......##.",
            "##.#.##.##",
            "####...#..",
            "#.##...###",
            "##...#...#",
            "#......#..",
            "#..#....##",
            "##......#.",
            "..##...#.#",
            "#..###..##",
            "",
            "Tile 1049:",
            "..#.##.#.#",
            "##........",
            ".#......#.",
            "#...###..#",
            "........#.",
            "....#.#...",
            ".###..###.",
            ".#....#...",
            "#....#...#",
            "#....#..#.",
            "",
            "Tile 1543:",
            "###...#..#",
            ".........#",
            "#.....##.#",
            ".#...#...#",
            "....#.#...",
            "...#.....#",
            "#..#.....#",
            "..#.......",
            "#......#..",
            "..#..###..",
            "",
            "Tile 2069:",
            "##..#.#.##",
            "#...#....#",
            "#...##....",
            "#..#......",
            "#...#....#",
            "....#....#",
            ".........#",
            "#.....###.",
            "...#.....#",
            ".##.#.#...",
            "",
            "Tile 2687:",
            "#.#..#....",
            "#.#..#....",
            "#....#....",
            "..........",
            ".....#...#",
            "#........#",
            "....#.....",
            "...##...#.",
            "#.......#.",
            "##....#.##",
            "",
            "Tile 3691:",
            ".######.#.",
            "..#..##..#",
            "#.....#...",
            "......#...",
            "#.##.#..##",
            "##....#..#",
            "....#....#",
            ".##..#....",
            ".........#",
            ".#..#.#..#",
            "",
            "Tile 2521:",
            "#..#.###..",
            "#.#.......",
            "##..##..##",
            ".....#.#..",
            ".....#..##",
            ".###....#.",
            "#.....##.#",
            "#.....##.#",
            "#.#.#...##",
            "###.#...#.",
            "",
            "Tile 1093:",
            "#..#######",
            "#......#.#",
            "..........",
            "..#....#.#",
            "##.##....#",
            "..#..#...#",
            ".....##...",
            "#.....#..#",
            "#.#.#.#..#",
            "#..##.####",
            "",
            "Tile 2341:",
            ".####.#.#.",
            "#.#...#..#",
            ".....#...#",
            "#....#..#.",
            ".........#",
            "#......###",
            "..#.#.....",
            "#.......#.",
            "#.#.#.....",
            "######....",
            "",
            "Tile 2903:",
            "#.#.###.##",
            ".#...#....",
            "........#.",
            "..#.......",
            "#......##.",
            ".#...#...#",
            ".#...#....",
            "#.##.....#",
            "..........",
            "....#..#..",
            "",
            "Tile 3413:",
            "...#.####.",
            "#...#...##",
            ".....#.#.#",
            ".#.#..#...",
            ".#.......#",
            "#.......#.",
            "#....##...",
            "..#....#..",
            "......##..",
            "....#.####",
            "",
            "Tile 2213:",
            "###...####",
            "..#....#..",
            "..##...#..",
            "...#.#....",
            "#..##.#.#.",
            "..#..##...",
            ".##..##...",
            "........##",
            ".#..#.....",
            "##..#.####",
            "",
            "Tile 1931:",
            "#.#.##.###",
            ".........#",
            "........##",
            "..........",
            ".#.....##.",
            "#.#.#....#",
            "#.....#..#",
            ".......#..",
            ".#........",
            "#.......#.",
            "",
            "Tile 1373:",
            ".###.#..##",
            ".#.....#.#",
            ".....###..",
            "....#...#.",
            "..........",
            "##..#....#",
            "#.........",
            "...#...##.",
            ".......#.#",
            "......####",
            "",
            "Tile 1229:",
            "#..#..#.##",
            "..........",
            ".#........",
            ".......##.",
            ".......#.#",
            "#..##....#",
            "#.#....#.#",
            ".#.....#.#",
            ".........#",
            ".##..###.#",
            "",
            "Tile 1361:",
            "...#.....#",
            ".#......#.",
            "#.#.#....#",
            "#........#",
            "......#.##",
            "#.....##..",
            "#.......#.",
            "........#.",
            "#...#.#.##",
            "##.#.#.###",
            "",
            "Tile 1031:",
            "###.#.#.#.",
            "#...##....",
            "#..#.#...#",
            "#...#..#.#",
            ".#.....#..",
            "......#..#",
            ".###...##.",
            "..#.#....#",
            "...#...#.#",
            "##...#.##.",
            "",
            "Tile 1451:",
            "..#.##.#.#",
            "....#..#..",
            ".#......#.",
            ".......##.",
            "#.#.#.....",
            ".......#.#",
            "##..#...##",
            "......#...",
            ".#........",
            ".##...#.##",
            "",
            "Tile 3943:",
            "..#.#.##.#",
            ".........#",
            "#........#",
            "#..#..#..#",
            ".#.#......",
            ".##...#...",
            "##....#..#",
            "..#.#.....",
            "..#.......",
            "#..##.###.",
            "",
            "Tile 2393:",
            "...###..#.",
            ".........#",
            ".....#..##",
            ".##....###",
            "..........",
            "#.........",
            ".#.###...#",
            "..##.....#",
            ".#.####..#",
            ".#.#.#..##",
            "",
            "Tile 1531:",
            "..#.#####.",
            "#........#",
            "...##..#..",
            "#..#.....#",
            "#........#",
            "##...#.#..",
            ".#......##",
            "..........",
            "#.#.#.##.#",
            "#....##.##",
            "",
            "Tile 3923:",
            "##...#....",
            "......##.#",
            "...#..#...",
            ".....#....",
            ".....#..##",
            "#..######.",
            ".........#",
            "#......###",
            "##.....#.#",
            "#..#.#...#",
            "",
            "Tile 1471:",
            ".#.#.#.#.#",
            "##...#...#",
            "..#.......",
            "#.........",
            ".....#..##",
            "#..##.#.#.",
            "#........#",
            "#...#.....",
            "#...#....#",
            ".#####.##.",
            "",
            "Tile 1123:",
            "#..###...#",
            "#.##.##.##",
            "##.....#..",
            "#.......##",
            ".......#.#",
            ".....#.###",
            "......#..#",
            ".....#...#",
            "#.#....#..",
            "##.#.#..##",
            "",
            "Tile 1907:",
            "###.#....#",
            "#..#..#.##",
            "...###....",
            "#....#...#",
            ".....#.#.#",
            "#....#....",
            "#.........",
            ".#......##",
            "#........#",
            "###...###.",
            "",
            "Tile 2371:",
            "##.....###",
            "..#...#.#.",
            "#.......##",
            "#.###..#..",
            ".......##.",
            "#..##.#..#",
            ".#..#..#.#",
            "##......##",
            ".#.....#.#",
            ".######.#.",
            "",
            "Tile 1117:",
            "####..#..#",
            "...##....#",
            "#.........",
            "#.#..#...#",
            "#..##....#",
            "#....#....",
            ".#..###.##",
            ".#.#..#.##",
            "#........#",
            "....#..#.#",
            "",
            "Tile 1553:",
            "########.#",
            "##.....#.#",
            "..#..#.#..",
            "..#..#....",
            "###......#",
            ".#..#.#...",
            "..#.......",
            "........##",
            "........#.",
            "#.#.......",
            "",
            "Tile 3709:",
            "##..#...##",
            "...#.#....",
            "#........#",
            "...#..#...",
            "#.......##",
            "#..#.##...",
            ".........#",
            "..#.....##",
            "#....#...#",
            ".###.#..#.",
            "",
            "Tile 2221:",
            "#.####..##",
            "....#.#...",
            ".........#",
            ".....#..#.",
            "....#...#.",
            "#..##.#...",
            "#..##.....",
            "#.#..#..##",
            ".#...#....",
            "##.#.#.##.",
            "",
            "Tile 1303:",
            ".#..######",
            "..###....#",
            "#.........",
            "###....#.#",
            "..#......#",
            "##...#....",
            "..........",
            "#.....#...",
            "#........#",
            "#.#.#.###.",
            "",
            "Tile 3391:",
            "##..##...#",
            "#..#.....#",
            ".......##.",
            "#..#......",
            "....#.....",
            "#.##..#..#",
            "..###..#.#",
            "#.......##",
            ".......#..",
            "#..#.#.#.#",
            "",
            "Tile 1433:",
            "##..#..##.",
            "#.........",
            "..........",
            "....#.....",
            ".......#..",
            "##..#....#",
            "#.....#..#",
            "..........",
            "..#...#.##",
            "..#.#...#.",
            "",
            "Tile 1163:",
            ".###.##.##",
            "#.........",
            "#.......#.",
            ".......#.#",
            ".........#",
            "##....#..#",
            "#......##.",
            "#....#.#.#",
            ".........#",
            ".#...#..#.",
            "",
            "Tile 2113:",
            "###..###.#",
            "...#..#...",
            "#...##...#",
            ".........#",
            "...#.#....",
            ".#....#...",
            "..#.##....",
            "....#.....",
            "#..##.#..#",
            "##.#...##.",
            "",
            "Tile 3023:",
            ".####.####",
            "#....#....",
            ".#...#..#.",
            "##......#.",
            "#......#..",
            ".........#",
            ".......#..",
            "#....#.###",
            "#..#..##..",
            ".#.##.##..",
            "",
            "Tile 1103:",
            "......#.##",
            "#..#..#...",
            "..#.#..#.#",
            ".#..#....#",
            "..##...##.",
            "##.##.....",
            ".#..#.....",
            "#.#...#..#",
            "..#...#.#.",
            "#.#####.#.",
            "",
            "Tile 3469:",
            "..##.#....",
            "....##..#.",
            "..........",
            "#........#",
            "##....#..#",
            ".........#",
            "#..#.#.#..",
            ".........#",
            ".#..#..###",
            "##.#..#...",
            "",
            "Tile 3671:",
            "..#.....##",
            ".....#....",
            ".#......#.",
            ".#...#.#..",
            ".#........",
            "#.##......",
            "#.#...#.#.",
            "#..#....##",
            "..#.......",
            "###.######",
            "",
            "Tile 1213:",
            "#..#......",
            "...#.....#",
            "#.......##",
            "....##....",
            "....#.#..#",
            "#.#......#",
            "#.........",
            "#..#..#...",
            "#....#....",
            ".#.##.###.",
            "",
            "Tile 2063:",
            ".##...##.#",
            ".......#..",
            "#........#",
            "..#...#...",
            ".###.....#",
            "#........#",
            "#..##.#.#.",
            ".....#....",
            "......#.#.",
            ".####...#.",
            "",
            "Tile 1753:",
            "#.##.##.##",
            "###.#.#..#",
            "#........#",
            "##....#..#",
            "....#.....",
            "#....#.##.",
            "..#..#....",
            "...#.#....",
            ".....#..##",
            "##.##....#",
            "",
            "Tile 2309:",
            "#..#..#.##",
            "#.......##",
            "#..#......",
            ".......#.#",
            "#..#.....#",
            "##.#.#...#",
            ".#.#....#.",
            "#....#....",
            ".##.......",
            "#..#....#.",
            "",
            "Tile 3767:",
            "#......#..",
            ".#.#..#.#.",
            "#........#",
            "..#.#.....",
            "#....#...#",
            ".#..#..#..",
            "#.....#..#",
            "#.........",
            "..#....##.",
            ".##.#.###.",
            "",
            "Tile 1321:",
            "#.####...#",
            "#.#...#..#",
            "##........",
            ".......#.#",
            ".#....#.#.",
            ".#..##....",
            "#.#....#.#",
            "........##",
            "..#.##...#",
            "#..#.#.#.#",
            "",
            "Tile 2731:",
            "..#.#..###",
            "#..#......",
            "..#....###",
            "...#..#..#",
            "..........",
            "..#.....##",
            "#..###....",
            "..........",
            "#...#.....",
            "#......#..",
            "",
            "Tile 2803:",
            ".#.#.##.#.",
            "##..##...#",
            "...#..#..#",
            "..#.#..#.#",
            "#.#..##..#",
            "##.#..#..#",
            "...###.###",
            "##.#..#...",
            "..#.......",
            ".......#..",
            "",
            "Tile 3191:",
            ".###..#.#.",
            "###.#...#.",
            "........##",
            "....##...#",
            ".....#....",
            ".#.......#",
            "..........",
            "..#...#...",
            "..###.....",
            "##.....#.#",
            "",
            "Tile 2753:",
            "..#.#####.",
            "....##..#.",
            ".........#",
            "....##....",
            "#..#...##.",
            "#.....#..#",
            "..........",
            ".##.......",
            "#.....#..#",
            ".##..#.##.",
            "",
            "Tile 2789:",
            "##.#...#..",
            "#.....##..",
            ".....###..",
            "#.#.....##",
            "#.#...##.#",
            ".........#",
            "##.......#",
            "##......##",
            "#..#..###.",
            "..###....#",
            "",
            "Tile 2719:",
            "##.###.#.#",
            ".........#",
            "#....##...",
            "...#..#...",
            "##.......#",
            "....##...#",
            "..#...#..#",
            "##.#.....#",
            "##....#..#",
            ".#####...#",
            "",
            "Tile 2143:",
            ".######..#",
            "#......#..",
            "#.......##",
            "....#....#",
            "#...#.....",
            ".........#",
            "....#.#..#",
            ".......#.#",
            "..........",
            "#.##....##",
            "",
            "Tile 2411:",
            "..#.#..##.",
            "##...##..#",
            "...###...#",
            "..#......#",
            "#.###.....",
            ".........#",
            "..#.##....",
            "#..#....##",
            "#..#..#..#",
            "....##...#",
            "",
            "Tile 1187:",
            "##.##.....",
            "##..#....#",
            "..#..##...",
            "##.#......",
            ".#..##....",
            "#....#....",
            "..........",
            "##.......#",
            "#..##..#.#",
            "#..#.####.",
            "",
            "Tile 3049:",
            "..#..#.#.#",
            ".....#....",
            "#........#",
            "#...#..#..",
            ".........#",
            "..#...#.#.",
            "#.#....#..",
            ".....#....",
            ".......#..",
            ".#.#.#.##.",
            "",
            "Tile 1997:",
            ".##.#.###.",
            ".....##...",
            "....###..#",
            "#....#...#",
            "#.....#..#",
            "#...#..#.#",
            "....##...#",
            ".##..#....",
            "#...#.....",
            "#.#.###.#.",
            "",
            "Tile 3181:",
            "...#..#..#",
            "..#..#..##",
            "........#.",
            "..........",
            "#......#.#",
            "##........",
            "##.....#..",
            "#.....##.#",
            ".#..#.....",
            "##.....###",
            "",
            "Tile 3371:",
            ".#....###.",
            "#.....#...",
            "##........",
            "#.#.......",
            "#........#",
            ".#.......#",
            "#........#",
            "...#.....#",
            "..#.##.#..",
            "...#..####",
            "",
            "Tile 3491:",
            ".#.##...#.",
            "#..#..##..",
            "..#.####.#",
            "...#......",
            "#...#....#",
            "#.........",
            ".....#..##",
            "#...##....",
            "##.....#..",
            ".####.....",
            "",
            "Tile 2999:",
            "#..#.##.##",
            ".#.#.....#",
            "#.#.......",
            "...#.....#",
            ".........#",
            "###...#..#",
            "..#......#",
            "#...#.#...",
            "..........",
            ".#....####",
            "",
            "Tile 1423:",
            ".....###.#",
            "##.#......",
            "#......#..",
            "##...#...#",
            "#.#.#..#..",
            "#.##......",
            ".....#...#",
            ".#.......#",
            "......#..#",
            "#.#..#####",
            "",
            "Tile 3739:",
            ".#...###.#",
            "..#...#...",
            ".#.#.#....",
            "....#.....",
            "..........",
            ".#.#...###",
            "#.........",
            "#...###...",
            "#....#..##",
            "#..#.....#"
        };
#endif
        #endregion Data
    }
}
