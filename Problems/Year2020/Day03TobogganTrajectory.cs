using System.Collections.Generic;
using Microsoft.Extensions.Logging;

namespace AdventOfCode.Problems.Year2020
{
    class Day03TobogganTrajectory : ProblemBase<long>
    {
        public Day03TobogganTrajectory(ILogger logger) : base(logger, "Toboggan Trajectory", 2020, 3) { }

        protected override long ExecutePart1()
        {
            return GetTreeCount(1, 3);
        }

        protected override long ExecutePart2()
        {
            var slopes = new List<(int down, int right)>()
            {
                (1, 1),
                (1, 3),
                (1, 5),
                (1, 7),
                (2, 1)
            };

            long product = 1;

            foreach (var (down, right) in slopes)
            {
                product *= GetTreeCount(down, right);
            }

            return product;
        }

        private static int GetTreeCount(int downSlope, int rightSlope)
        {
            int treeCount = 0;

            int iCol = 0;
            for (int iRow = 0; iRow < rows.Length; iRow += downSlope)
            {
                if (GetCharacter(iRow, iCol) == '#')
                {
                    treeCount++;
                }
                iCol += rightSlope;
            }

            return treeCount;
        }

        private static char GetCharacter(int iRow, int iCol)
        {
            string row = rows[iRow];
            return row[iCol % row.Length];
        }

        #region Data

        private static readonly string[] rows =
        {
            ".#......#..####.....#..#.......",
            "#.#...#...#..#.#...#.#...##.##.",
            "#.#....#..........#...##.....##",
            "#.#.#.....##......#.#.......###",
            "..#..###....#.#....#.#.#..#....",
            ".......#.#....##..##...#...#...",
            "..#..#..#..###.......#.....#.#.",
            ".#.......#...##...##.##......##",
            "#.#.##..##.#..#....#..###..#.#.",
            "#.....#.#.........#.....##.#.#.",
            "..#.#....##..#...#...##........",
            "......#....#..##.#.#......###..",
            ".......#.......#......##...#...",
            ".##.....#.......#...###.....##.",
            ".#...#.##..##.#..##....#.......",
            "..#......##...#..#...#.#.##.###",
            ".##.##.....##....#..#......#.#.",
            ".#.....#..###..#.##.#.....##.#.",
            "......##..........#..........#.",
            ".##....#.....#..##.#..#.#..###.",
            "..##.......#....#...##...#..#..",
            ".##...#.....#.###.#.#..#...#.#.",
            ".....##.#.##..##...#...........",
            "..#..###.##.#.#.###...###..#.#.",
            ".#........#..#.#........#.#...#",
            "....##.......#....#.#.##.#.....",
            "....##........######..###..#.#.",
            "#.#.#............#.......#..#..",
            "...##...#.##.....#.#..#......#.",
            "......#.##.#....##..#.#..###...",
            "##.....#.#....#....#.##.#.###..",
            "#..#..#..##.#..##.##.##.#.##...",
            ".###.####..#..#........#.....##",
            ".......##..#.......#...........",
            ".##...#............#.#.##...#..",
            "....##.....#...##..#..#.#..###.",
            "...#.....#####.#..#...##....##.",
            "#.....#.#.#....##.......##.#.#.",
            "......#.#..#.##.#######......#.",
            "#.##...##....#..###.#.......#..",
            ".....##...#....#...#....##.##.#",
            "....###......#...###..#......##",
            "..#...##..##.######..#.#......#",
            "......##....#....##..#......##.",
            ".#...#..##..#.###.#......#....#",
            "##....##..#..####.#.....#...#..",
            ".#.......#...#.......##......#.",
            "......#...#...#........#.......",
            ".#........#.###...#..####.#..#.",
            "##...#.#............#.....###..",
            ".....###.#.##...........###..#.",
            ".#.#...#.....#.#.##..##...####.",
            "..##.......#..#.##.#....#.....#",
            ".#..#.#..####.....###.#.....#..",
            "..#..###.....####..#.##.#.#.##.",
            ".###..#.....#......#...####....",
            "...#.#..#.#..#...#...#....##.##",
            "..###....#.##.....#..........#.",
            "###...#####......##............",
            "..###.....#........##.#...#..#.",
            "..##.##.#.....##........##..#.#",
            "##..#.#...#.#..#..###.#....#..#",
            "....#..#.#.....#..#####...#....",
            "....#.........#......##.##.....",
            ".#...####.##......##..##.#..#.#",
            "...#...#.##..#...##..###...#...",
            "###...#.....#.##.###.###..#.#..",
            "..#......#.###.....#..##.#...#.",
            "#.....##.########...#####....#.",
            "........##..#..##..##.#........",
            "....#.######....##..#..#.##..#.",
            "#.......#..##..#..#.#.#..##.##.",
            "...#.#..#..#.......#......###.#",
            ".#.#..#.#..#.##.#.............#",
            "#....#.##.#.#.....#..#.#..#....",
            "...###..#...#....#.........#.#.",
            ".#..#.....##..#.#..#.#.......#.",
            "..#...##...#......#......####..",
            "....#..#.......#.......#.#..#..",
            "#...#..#...........#.#..#.....#",
            "#...#.#.......#...#....###....#",
            ".#..#.#.##....#......#........#",
            "..#...#..##..#..#..#..#...#.#..",
            "..#.#.........#....#....##.....",
            "##.....##.#.#.#.........##.....",
            ".##...#.##...........#...#...##",
            ".##..##.#.#..........##..##....",
            "#....#....#.#...#.#..#....#.#..",
            "####....##.....#..##.###.......",
            "#..#....#......##.#.#....#.....",
            ".....#....#.###.##.........###.",
            "#.......#.####..#..#..##.......",
            "##.#.......#..##..#....#..#.#..",
            "..###...#.#...#.....##.##.####.",
            "....#...#.#....#..#..#.....#.##",
            "#.....##.#.#..#.##..#..##......",
            "................###..#....##...",
            "..#.##.....#..........##.#...#.",
            "..#.#..#.#....#.#.#..#..#..#.#.",
            "#...#..##.#.#...#..#...#..#....",
            "#..#.#.........#..###........#.",
            ".#...#.............#..###..#..#",
            "#.........#.#..#...#.#.....#..#",
            "....#..#..#.#.#...#...#.....##.",
            "##...###.#.####..#......#...#..",
            "..#..##...#.#......#.#.......#.",
            "#......###....##.#.##..........",
            "#####....###..#...............#",
            "##.#...####....#....#...#....#.",
            ".#.......#..#.....#...#.....###",
            "...#..#.#.#....##......##...#..",
            "...#.....#...#.##.#..#.#....#..",
            "#...###....#...#.#....#........",
            ".#.......#........#...##.##.##.",
            ".....#....#...##.....##...###.#",
            "....#....#.#..#...##.##.##.....",
            ".......#............#...#.#..#.",
            ".#............#.....##.......#.",
            "........#....#....##......##.##",
            ".......##..#.#..#.##..###..##.#",
            "#..##..##.........####.#.###...",
            "#....#..#...##...#.............",
            "#...#...###..........##..#..#..",
            "....#...#..#.....##...#........",
            "#.....#......#.#.....#...#..#..",
            "..#.....#.....#....#..#........",
            "..#..#.....#.#.........#..###..",
            "................###..#.#....#..",
            "#.....#.....#.#.#.#.#..#...#.#.",
            "#....#....#.#..........#.#....#",
            "....#..#......#..##.#...##.....",
            "..#.#...#.####....#.#..#.#..#..",
            ".........##......#.....##......",
            "##.#.###.#.....#.....####.#..#.",
            ".....#.....#..#....#..###.#....",
            "##..#.#...#.##....#....#.......",
            ".....#......#.#...##..#.#......",
            "....##..#...#...##..##.#....#.#",
            "............#..........##.#....",
            "##..#..#.##..##..#.#....#.#.#..",
            ".......#.#...#...#.#...#..#....",
            "#....#.#...#...#........#..#...",
            "...........#.......#...##..###.",
            ".#..##......#.##.........##..#.",
            "...#...#...###.#.##....##.#..#.",
            "#...#..#.#.#.....##..#.......#.",
            ".##..#.###.##......#.#....#.#.#",
            "..#....#.......#..#..#.#.#.##..",
            "#...#...###...###.........#....",
            ".#.#...#.....##.#.#..#....#.##.",
            ".........#.#.##.....#.#.###....",
            "...#.#...#......#...####......#",
            "...##..##....##......##...###..",
            "###...#..#.......##.....#....#.",
            "...#..#..#..###...##.##..#..#..",
            "...#......#......##..#.#.##..#.",
            "...#.........#....#.#....#.#...",
            "##................#..#.#.....#.",
            "....#.##...#..#.##...##.#.....#",
            "......#..##.##..###.#..#.##.##.",
            ".#.#...###.....###.....##...###",
            ".##.....#.#.#..#..###..#..#..#.",
            "#.......#..#..#....##.....#....",
            "...#.#.##..#..#......##.##...#.",
            "....##.#......#...#..#..#......",
            ".####.#..#.....#..##.#...##..##",
            "..#..#...#..........###..#....#",
            ".#.#.##.##...#............#....",
            "........##..##......#.##..#.###",
            "...#.#....###......##.......#..",
            "..##...#...#.#..#.....#.....#..",
            "##..#...###..#..#.#.#...#...#..",
            ".....#..#....##.....##.....###.",
            "....##...###.#..#.#....##..#..#",
            "#......#...#....#......#...##..",
            "....#.##...#.#......#.#.##...#.",
            ".......#.....#...#####...#.#...",
            "...#.....##.#............#.....",
            "...#.#........#.#.#..#.........",
            "....###......#.#.#..#.####.#..#",
            "#.....#.#.#.....#.#.#.....#..#.",
            "..##.##......#...#.#...........",
            "###..###....#.#####......###...",
            "..##..............##.#.#....#.#",
            "#..#...#..........#..#.#.#..###",
            "##.###............#....#.#...#.",
            "#.#..#.#..##.#.#....#...#......",
            "#....#...#..##.....#..#.#..###.",
            "..#.....#.#....#.#..#.##.#..##.",
            "...##...#.#.##...#....###....#.",
            "......###.####.......#..#.#.#.#",
            ".#..............##........#....",
            "...##.##...##....#..#.......#..",
            ".....#.....#....###...#..#..#.#",
            ".#.....#..#.....#......#.....##",
            "#.#.##.#..#..#.....#.##..###...",
            "..#......#...##.###..#.#...#..#",
            "......#.....#...##......#......",
            "##.#........#..........#.....#.",
            "#........##.#............##....",
            "...#......##...#.#.....##......",
            "...##.......#....#.#..#.#.###..",
            "..#....##..##.##.....###....#..",
            "..#...#.#...#.....#..........#.",
            "......#...#...#.#.##.#...#.#.#.",
            ".#...#......#.##........#......",
            ".##.##..#....#...#.#...##......",
            "#..#......#.#...........#....#.",
            "....##.#....#...#..#....#.#..##",
            "#....##.##....#.#..##.#........",
            ".##.##.#....##.....#..#....#..#",
            "...#...#.....###.#.##..........",
            "....#...#....##.......###......",
            "#.........#......#.#.......#...",
            "#..........#..##..#.#..........",
            ".....#.......#..##.##....##...#",
            "........................#.#....",
            "#..#.........#.............#..#",
            "#..#.....#.......#....#....#.#.",
            "..##..##.......##....#...#.....",
            ".##......#..##......#.###......",
            "...#.#........#.......##..###..",
            "..##...###.###......#...#....##",
            "#...#...#.....###.#.#.#..#.....",
            "#....#.........#..##...#...##..",
            "#..###..#.#.#.##.#..#.#....#.##",
            "#...#.#.....#.###.#.......#....",
            "..##..#..#....#.#...........#.#",
            "#.........#.#......#...##......",
            ".######......#..#....#.#.#....#",
            "##..#.#..####.###.........#....",
            "###########.....##.##...#..#...",
            "#...##.#.#....#.#....#......#..",
            "...#..##..#..##..#......#....#.",
            ".#....#...#....#.#..##....##...",
            "#..#.#............#....#.#...#.",
            "...#...#..#.#.##......#..#.#...",
            "#.#...##.....#..#.##......####.",
            ".#.#..##..#.....#.#..#.##......",
            "#.#.##......##.....#..#.#..#...",
            "#..##...#.##.#.......#.##......",
            "..#.......#.#.#...##..##...#...",
            ".#...#..#..#.#.........#..##...",
            "#..#.......#....#.#...#.###...#",
            ".......#..#.......##.#.#...#.#.",
            ".#.................###.#..###..",
            "..........#.#.....##..#####...#",
            "#......#.#..##.#.#...#.##.#....",
            "#......#.#..##.##.#...#....#...",
            "....#..#......#....#....#######",
            ".#...#......#....###......#.###",
            "#.#....#.#...#.###......#..#..#",
            ".###......#.#...#.####.#..####.",
            "######.#.....###.#...#.#.....#.",
            ".#.###....#..#.#.....#.....####",
            ".......###.#.........#..#......",
            "#...#.....##.#......####.......",
            "..#.#..##.#.#...#...#..##..##..",
            ".....#...##.....#...##......##.",
            "##..#..#.##..#.#......#.....#..",
            "##.........#.#.##.#..#.#....#.#",
            ".#........###...#.........#....",
            "...#..#.#..#....####...........",
            "#.#....#..##..####.#...#.##....",
            ".#.....#.......#..........#..##",
            "...#.......#...###..#.....#..##",
            ".........#.###.#..##...#.##...#",
            ".#..........##..####...#..#.#.#",
            ".#...##...#............##...#.#",
            "...#....#.#..........#.#..#.#..",
            ".#.#...##....##.#.#.#....#.....",
            "....#..#.....#.#..#.#..#.##.###",
            ".....#.#.....#..#......#.#.#...",
            ".....#.#.#..###..#.#..###...#..",
            "#.......####...#.#..#......##.#",
            "....#..#..###......###.##....#.",
            "##.....#.....#.............#..#",
            "#..#..#...##.....##..#..#.#....",
            ".....#.#.###...#...............",
            "#.#.#.....#.#..#.#...#.......#.",
            "..##.##............#....#..##..",
            "#....##...#.....#.###...#.#....",
            "#...##.#.........#...#....#....",
            "##.##.#...#.#...###..#....##..#",
            "....#....##..#..#.......#...##.",
            ".#...#...#..#.....#..###.#..#.#",
            "....#..###......#....##....#...",
            "#.#.....#....##.#..#.#...###...",
            ".......#............#......#...",
            ".##..#.###.#.............###...",
            "..##...##.#.#.#.....#........##",
            "....#.###....#..#..#...#...#..#",
            ".....#...#...#..#....#.....##..",
            "###.#.#.....#......####.....#..",
            "#.#.###............#......#....",
            "..#.....#..#..#..#....#......#.",
            "#...######...#....#.##...##.#.#",
            "##.#.#.#..##......##.#..#.#...#",
            "............#.#..#.##....#.....",
            "......#............#.#...#..#.#",
            ".#..##...##..#.#.#..###.....##.",
            "#.###.#...........#...#....#...",
            "....##.....#...##...#...###.#.#",
            ".####.#.#.....#.#..#.#.##......",
            ".#...##......###...#..##..#.#..",
            ".#......#...#....##.....##..#..",
            "..........##.....###.##.#...#.#",
            ".#........##.#..............#..",
            "#...###..#...#.....#....#.....#",
            "...#......#..#...#...#..###.#..",
            ".#...##..#........#.......#.#..",
            ".#.#.##.........##.##......#..#",
            "#...#.#.#...#.....#.#...#.#..#.",
            "#.#..#...#...#...##..........#.",
            ".#...........#....#..#.#..#.#..",
            "#.......#......#..#...#........",
            ".....#..#...##..###..##........",
            "......#...#.....#..#.#.#....##.",
            "....##..##..##....###.##.......",
            ".#........##.#.#...#..#........",
            ".....##...##...#......#..#...#.",
            "..#.....#....###.#..##....#..#.",
            "......#..#...####.#.....##.####"
        };

        #endregion Data
    }
}
